from agent import *from models.products import *debug = Truedef process_revlist(data, context, session):    revs = data.xpath("//div/a[@class='more']")    for rev in revs:        url = rev.xpath("@href").string()        session.queue(Request(url, use='curl'), process_review, dict(context, url=url))        nexturl = data.xpath("//ul[@class='pagination']/li[@class='active']/following-sibling::li[1]/a/@href").string()    if nexturl:        session.queue(Request(nexturl, use='curl'), process_revlist, dict(context))def process_review(data, context, session):    product = Product()    product.name = data.xpath("(//div[@class='rb_content']//h1)[1]//text()").string()    product.ssid = context['url'].split('/')[-1].replace('.html', '')    product.category = data.xpath("//div[@class='rb_content']//p/a[@id='pl-gallery-trigger']//text()").string() or 'Review'    product.url = context['url']        review = Review()    review.title = product.name    review.date = data.xpath("//div[@class='rb_content']//span[@class='mod-date']//text()").string()    review.ssid = product.ssid    review.type = 'pro'    review.url = context['url']        excerpt = data.xpath("//div[@class='rb_content']//p//text()").string(multiple=True)    if excerpt:        review.properties.append(ReviewProperty(type='excerpt', value=excerpt))    product.reviews.append(review)    session.emit(product)    def run(context, session):    session.queue(Request('https://fotovilag.hu/content/index/cat/2', use='curl'), process_revlist, {})