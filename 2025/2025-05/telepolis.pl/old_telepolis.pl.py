from agent import *from models.products import *debug = Truedef process_revlist(data, context, session):    revs = data.xpath("//a[@class='news-box mobile-simple px-4 mb-4']")    for rev in revs:        url = rev.xpath("@href").string()        session.queue(Request(url), process_review, dict(context, url=url))        nexturl = data.xpath("//li[@class='page-item next']/a[@class='page-link']//@href").string()    if nexturl:        session.queue(Request(nexturl), process_revlist, dict(context))def process_review(data, context, session):     product = Product()    product.name = data.xpath("//h1//text()").string()    product.ssid = context['url'].split('/')[-1].replace('.html', '')    product.category = data.xpath("//p[@class='pr-4 mb-0'][2]//a//text()").string(multiple=True)    product.url = context['url']        review = Review()    review.title = data.xpath("//h1//text()").string()    review.date = data.xpath("//time[@class='pr-4']/@datetime").string()    review.ssid = product.ssid    review.type = 'pro'    review.url = context['url']        author = data.xpath("//p[@class='pr-4 mb-0'][1]/b//text()").string()    review.authors.append(Person(name=author, ssid=author))        summary = data.xpath("//div[@class='lead']//text()").string(multiple=True)    if not summary:        summary = data.xpath("//div[@class='infinite-item']/p[3]/strong//text()").string(multiple=True)    if summary:        review.properties.append(ReviewProperty(type='summary', value=summary))        excerpt = data.xpath("//div[@class='infinite-item']/p//text()").string(multiple=True)    if not excerpt:        excerpt = data.xpath("//div[@class='artykul-content']//text()").string(multiple=True)    if excerpt:        if summary:            excerpt = excerpt.replace(summary, '')        review.properties.append(ReviewProperty(type='excerpt', value=excerpt))        if summary or excerpt:        product.reviews.append(review)        session.emit(product)def run(context, session):    session.queue(Request('https://www.telepolis.pl/artykuly/testy-sprzetu'), process_revlist, {})