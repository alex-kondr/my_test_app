from agent import *from models.products import *debug = Truedef process_frontpage(data, context, session):    for link in data.xpath("//tr[regexp:test(normalize-space(.), '^Archief Hardware$')]/ancestor::table[1]/following-sibling::table[1]//a"):        url = link.xpath("@href").string()        title = link.xpath("font[@class='toon_tekst']/text()").string()        if url and title:            session.queue(Request(url, use="curl", max_age=0), process_review, dict(url=url, title=title))def process_review(data, context, session):    name = context['title']    product = Product()    product.name = name    product.url = context['url']    product.ssid = get_url_parameter(product.url, 'id')    product.category = 'Hardware'    review = Review()    review.type = 'pro'    review.title = context['title']    review.url = context['url']    review.ssid = product.ssid    review.date = get_url_parameter(product.url, 'zoekdatum')    summary = data.xpath("//tr[regexp:test(normalize-space(.), '^Volledig artikel$')]/following::font[@class='toon_tekst'][1]//text()").string(multiple=True)    if summary:        review.properties.append(ReviewProperty(type='summary', value=summary))    product.reviews.append(review)    session.emit(product)def run(context, session):    session.queue(Request('http://www.netties.be/v20/hoofdpagina_headlines.php?headcat=Hardware', use="curl", max_age=0), process_frontpage, {})